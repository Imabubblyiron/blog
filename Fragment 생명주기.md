# Fragment 생명주기


Fragment는 FragmentActivity 내의 어떤 동작 또는 사용자 인터페이스의 일부를 나타낸다. 여러 개의 프래그먼트를 하나의 액티비티에 결합하여 창이 여러 개인 UI를 빌드할 수 있으며, 하나의 프래그먼트를 여러 액티비티에서 재사용할 수 있습니다. 아마도 우리가 프로젝트를 진행하다보면 이 상황에 자주 마주하게 될 것이다. 그만큼 프래그먼트는 쓰임새가 많다. Fragment는 자체적인 수명 주기를 가지고, 자체 입력 이벤트를 수신하고, 액티비티 실행 중에 추가 및 삭제가 가능하다(다른 액티비티에 재사용할 수 있는 "하위 액티비티"와 같은 개념)

프래그먼트는 항상 액티비티 내에서 불려지게된다. 해당 프래그먼트의 수명 주기는 호스트 액티비티의 수명 주기에 직접적으로 영향을 받는다. 예를 들어 액티비티가 일시정지되는 경우, 그 안의 모든 프래그먼트도 일시정지되며 액티비티가 소멸되면 모든 프래그먼트도 마찬가지로 소멸된다. 그러나 액티비티가 실행 중인 동안(재개됨 수명 주기 상태에 있을 경우)에는 각 프래그먼트를 추가 또는 제거하는 등 개별적으로 조작할 수 있는데 이 예제에 대해서는 기본서 뿐만아니라 일반적인 프로젝트에서 많이 사용되곤한다. 그와 같은 프래그먼트 트랜잭션을 수행할 때는 이를 액티비티가 관리하는 백 스택에도 추가할 수 있다. 또한 각 백 스택 항목이 발생한 프래그먼트 트랜잭션의 기록이 되고 이 백 스택을 사용하면 사용자가 프래그먼트 트랜잭션을 거꾸로 돌릴 수 있다.

글 참고 : https://developer.android.com/guide/components/fragments?hl=ko

![](https://t1.daumcdn.net/cfile/tistory/246FB73355B6FDE827)

위의 그림을 보며 아래 각 메소드에 대한 설명을 읽어보면 쉽게 이해될 것이다.
 
1. onAttach()

메소드들의 이름을 직관적으로 생각하면 이해가 잘 될것이다.
프래그먼트가 액티비티에 붙을 때 호출된다. 하지만 아직 완벽하게 생성된 것은 아니다.
이 말을 잘 생각해보면 이해할 수 있을것이다. Fragment는 Activity에 의존적이다.

2. onCreate()

본격적으로 프래그먼트가 액티비티에 호출을 받아 생성되는 시점이다.
액티비티의 onCreate()에선 view나 ui관련 작업을 할 수 있으나, 프래그먼트의 onCreate()에서는 할 수 없다.

3. onCreateView()

프래그먼트에 속한 각종 view나 viewGroup에 대한 ui 바인딩 작업을 할 수있다. (Layout을 inflater하여 View작업을 한다.)

4. onActivityCreated()

액티비티에서 프래그먼트를 모두 생성하고 난 다음에 호출된다. 즉 액티비티에서 onCreate()다음에 호출되는 녀석이다. 액티비티와 프래그먼트가 드디어 연결되는 시점이다.

5. onStart()

프래그먼트가 사용자에게 보여지기 전에 호출된다.

6. onResume()

프래그먼트가 비로소 화면에 보여지는 단계, 사용자에게 포커스를 잡은 상태, 사용자와의 상호작용이 가능하다.

 
 ## 중요
 
 여기서 눈여겨봐야 할 부분이 이 부분이다. 아래는 필자의 프로젝트중 코드를 가져왔다. 아래 코드만 보면 당연히 모르겠지만 설명하자면 add(R.id.container, FRAGMENT, tab.tag)하는 부분에서 tab에서 선택된 부분에 맞는 Fragment가 화면에 보여지게 코딩된 부분이다.  add를하여 commit하게 되면 현재 화면에서 보여지는 fragment는 onPause()상태가 되고 다른 프래그먼트가 화면에 보여지게 된다.


```kotlin

supportFragmentManager.beginTransaction().apply {
    if(fragment == null) {
        add(R.id.container
            , when(tab) {
            State.A -> FragmentA.instantiate()
            State.B -> FragmentB.instantiate()
            State.C -> FragmentC.instantiate()}
            , tab.tag)
    }
    ...
    
}.commit()

```


7. onPause()

프래그먼트는 사용자와의 상호작용을 중지한다. 
다시 돌아온다는 보장이 없으므로, 중요한 정보는 저장해 둔다.

8. onStop()

프래그먼트는 더이상 보여지지 않게되며,  프래그먼트 기능이 중지된다.

9. onDestroyView()

프래그먼트안에 있는 모든 view들을 제거하기 시작한다.
backstack을 사용했다면, 다시 해당 프래그먼트로 돌아 올때 onCreateVeiw()가 호출된다.

10. onDestroy()

프래그먼트를 제거하기 직전에 호출되는 메소드이다.

11. onDetach()

프래그먼트 비로소 제거하고 액티비티와의 연결도 해체시킨다.

